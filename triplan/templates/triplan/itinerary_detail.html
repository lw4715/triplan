{% extends "triplan/base.html" %}
{% block body %}
{% load humanize %}

<div class="panel col-sm-8 col-sm-offset-2">
    <div class="col-sm-12">
        <h2 class="center">{{ itinerary.title }}</h2>
        <small class="pull-right margin-bottom-5">added by {{ itinerary.owner }} on {{ itinerary.date_added | naturaltime }}</small>
    </div>
    <div class="col-sm-12 center-img">
        {% if itinerary.preview_photo %}
        <img src="{{ itinerary.preview_photo.url }}" class="img img-responsive full-width">
        {% endif %}
    </div>

    {# https://developers.google.com/maps/documentation/static-maps/intro #}
    <img src="https://maps.googleapis.com/maps/api/staticmap?size=600x300&maptype=roadmap\
    &markers=size:mid%7Ccolor:red%7C{{ itinerary.locations }}&key=AIzaSyBJz1pSa-my6Cq3DrqIy-MB0keiTHL-rq8"
        height="300px" width="600px" class="img center-img">

    <ul>
    {% for segment in itinerary.itinerarysegment_set.all %}
        <div class="panel-body">
            <div class="col-sm-4">
                <p>Location: {{ segment.location }}</p>
                <p>Duration: {{ segment.duration }}h</p>
                <p>From: {{ segment.start_time }}</p>
                <p>To: {{ segment.end_time }}</p>
                <p>Description: {{ segment.description }}</p>
            </div>
            <div class="col-sm-6">
                {% if segment.photo %}
                <img src="{{ segment.photo.url }}" class="img img-responsive full-width">
                {% endif %}
            </div>
            <div class="col-sm-2">
            {% if itinerary.owner_id == request.user.id %}
                <a href="{% url 'triplan:itinerary_edit' itinerary.id segment.id %}"
                   class="btn btn-info pull-right">Edit</a>
            {% endif %}
            </div>
        </div>

    {% endfor %}
    </ul>

    <div class="col-sm-12">
        <a href="{% url 'triplan:itinerary_list' %}" class="btn btn-default">Back</a>
        <a href="{% url 'triplan:itinerarysegment_create' itinerary.id %}" class="btn btn-success">Add New Segment</a>
    </div>
</div>
{% endblock body %}
